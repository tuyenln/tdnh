var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.findInternal=function(a,b,d){a instanceof String&&(a=String(a));for(var e=a.length,c=0;c<e;c++){var f=a[c];if(b.call(d,f,c,a))return{i:c,v:f}}return{i:-1,v:void 0}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,d){a!=Array.prototype&&a!=Object.prototype&&(a[b]=d.value)};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.polyfill=function(a,b,d,e){if(b){d=$jscomp.global;a=a.split(".");for(e=0;e<a.length-1;e++){var c=a[e];c in d||(d[c]={});d=d[c]}a=a[a.length-1];e=d[a];b=b(e);b!=e&&null!=b&&$jscomp.defineProperty(d,a,{configurable:!0,writable:!0,value:b})}};$jscomp.polyfill("Array.prototype.find",function(a){return a?a:function(a,d){return $jscomp.findInternal(this,a,d).v}},"es6","es3");$jscomp.arrayIteratorImpl=function(a){var b=0;return function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}}};
$jscomp.arrayIterator=function(a){return{next:$jscomp.arrayIteratorImpl(a)}};$jscomp.makeIterator=function(a){var b="undefined"!=typeof Symbol&&Symbol.iterator&&a[Symbol.iterator];return b?b.call(a):$jscomp.arrayIterator(a)};$jscomp.FORCE_POLYFILL_PROMISE=!1;
$jscomp.polyfill("Promise",function(a){function b(){this.batch_=null}function d(a){return a instanceof c?a:new c(function(b,g){b(a)})}if(a&&!$jscomp.FORCE_POLYFILL_PROMISE)return a;b.prototype.asyncExecute=function(a){if(null==this.batch_){this.batch_=[];var b=this;this.asyncExecuteFunction(function(){b.executeBatch_()})}this.batch_.push(a)};var e=$jscomp.global.setTimeout;b.prototype.asyncExecuteFunction=function(a){e(a,0)};b.prototype.executeBatch_=function(){for(;this.batch_&&this.batch_.length;){var a=
this.batch_;this.batch_=[];for(var b=0;b<a.length;++b){var c=a[b];a[b]=null;try{c()}catch(k){this.asyncThrow_(k)}}}this.batch_=null};b.prototype.asyncThrow_=function(a){this.asyncExecuteFunction(function(){throw a;})};var c=function(a){this.state_=0;this.result_=void 0;this.onSettledCallbacks_=[];var b=this.createResolveAndReject_();try{a(b.resolve,b.reject)}catch(h){b.reject(h)}};c.prototype.createResolveAndReject_=function(){function a(a){return function(g){c||(c=!0,a.call(b,g))}}var b=this,c=!1;
return{resolve:a(this.resolveTo_),reject:a(this.reject_)}};c.prototype.resolveTo_=function(a){if(a===this)this.reject_(new TypeError("A Promise cannot resolve to itself"));else if(a instanceof c)this.settleSameAsPromise_(a);else{a:switch(typeof a){case "object":var b=null!=a;break a;case "function":b=!0;break a;default:b=!1}b?this.resolveToNonPromiseObj_(a):this.fulfill_(a)}};c.prototype.resolveToNonPromiseObj_=function(a){var b=void 0;try{b=a.then}catch(h){this.reject_(h);return}"function"==typeof b?
this.settleSameAsThenable_(b,a):this.fulfill_(a)};c.prototype.reject_=function(a){this.settle_(2,a)};c.prototype.fulfill_=function(a){this.settle_(1,a)};c.prototype.settle_=function(a,b){if(0!=this.state_)throw Error("Cannot settle("+a+", "+b+"): Promise already settled in state"+this.state_);this.state_=a;this.result_=b;this.executeOnSettledCallbacks_()};c.prototype.executeOnSettledCallbacks_=function(){if(null!=this.onSettledCallbacks_){for(var a=0;a<this.onSettledCallbacks_.length;++a)f.asyncExecute(this.onSettledCallbacks_[a]);
this.onSettledCallbacks_=null}};var f=new b;c.prototype.settleSameAsPromise_=function(a){var b=this.createResolveAndReject_();a.callWhenSettled_(b.resolve,b.reject)};c.prototype.settleSameAsThenable_=function(a,b){var c=this.createResolveAndReject_();try{a.call(b,c.resolve,c.reject)}catch(k){c.reject(k)}};c.prototype.then=function(a,b){function d(a,b){return"function"==typeof a?function(b){try{e(a(b))}catch(l){g(l)}}:b}var e,g,f=new c(function(a,b){e=a;g=b});this.callWhenSettled_(d(a,e),d(b,g));return f};
c.prototype.catch=function(a){return this.then(void 0,a)};c.prototype.callWhenSettled_=function(a,b){function c(){switch(d.state_){case 1:a(d.result_);break;case 2:b(d.result_);break;default:throw Error("Unexpected state: "+d.state_);}}var d=this;null==this.onSettledCallbacks_?f.asyncExecute(c):this.onSettledCallbacks_.push(c)};c.resolve=d;c.reject=function(a){return new c(function(b,c){c(a)})};c.race=function(a){return new c(function(b,c){for(var e=$jscomp.makeIterator(a),f=e.next();!f.done;f=e.next())d(f.value).callWhenSettled_(b,
c)})};c.all=function(a){var b=$jscomp.makeIterator(a),e=b.next();return e.done?d([]):new c(function(a,c){function f(b){return function(c){g[b]=c;h--;0==h&&a(g)}}var g=[],h=0;do g.push(void 0),h++,d(e.value).callWhenSettled_(f(g.length-1),c),e=b.next();while(!e.done)})};return c},"es6","es3");
var $=jQuery,X_GOOGLE_API_KEY="AIzaSyDtupLwQ2KfzHCo37usxBecGKn3W65WQlQ",x={change_alias:function(a){a=a.toLowerCase();a=a.replace(/\u00e0|\u00e1|\u1ea1|\u1ea3|\u00e3|\u00e2|\u1ea7|\u1ea5|\u1ead|\u1ea9|\u1eab|\u0103|\u1eb1|\u1eaf|\u1eb7|\u1eb3|\u1eb5/g,"a");a=a.replace(/\u00e8|\u00e9|\u1eb9|\u1ebb|\u1ebd|\u00ea|\u1ec1|\u1ebf|\u1ec7|\u1ec3|\u1ec5/g,"e");a=a.replace(/\u00ec|\u00ed|\u1ecb|\u1ec9|\u0129/g,"i");a=a.replace(/\u00f2|\u00f3|\u1ecd|\u1ecf|\u00f5|\u00f4|\u1ed3|\u1ed1|\u1ed9|\u1ed5|\u1ed7|\u01a1|\u1edd|\u1edb|\u1ee3|\u1edf|\u1ee1/g,
"o");a=a.replace(/\u00f9|\u00fa|\u1ee5|\u1ee7|\u0169|\u01b0|\u1eeb|\u1ee9|\u1ef1|\u1eed|\u1eef/g,"u");a=a.replace(/\u1ef3|\u00fd|\u1ef5|\u1ef7|\u1ef9/g,"y");a=a.replace(/\u0111/g,"d");a=a.replace(/ + /g," ");return a=a.trim()}};
$.fn.serializeObject=function(){var a={};$(this).find('input[type="hidden"], input[type="text"], input[type="password"], input[type="checkbox"]:checked, input[type="radio"]:checked, select').each(function(){if("hidden"==$(this).attr("type")){var b=$(this).parent().find('input[type="checkbox"][name="'+this.name.replace(/\[/g,"[").replace(/\]/g,"]")+'"]');if(null!=b&&b.prop("checked"))return}null!==this.name&&void 0!==this.name&&""!==this.name&&(b=$(this).is("select")?$(this).find("option:selected").val():
this.value,void 0!==a[this.name]?(a[this.name].push||(a[this.name]=[a[this.name]]),a[this.name].push(b||"")):a[this.name]=b||"")});return a};x.call=function(a,b){x.loading(1);return new Promise(function(d,e){$.ajax({type:"POST",data:JSON.stringify(b),dataType:"json",contentType:"application/json; charset=utf-8",url:"/agencies/index.php?m="+a}).done(function(a){x.loading(0);return d(a)}).fail(function(a){x.loading(0);console.log("[ERROR]",a);return e(a)})})};
x.loading=function(a){var b=document.getElementById("loading");null!=b&&(b.style.display=a?"block":"none")};
x.hash_run=function(){-1!==window.location.hash.indexOf("#agencies")&&($(".wp-has-current-submenu").addClass("wp-not-current-submenu").removeClass("wp-has-current-submenu"),$(".wp-has-current-submenu").removeClass("wp-has-current-submenu"),$("#menu-agencies,#agencies-link").addClass("wp-has-current-submenu"),document.title="Agencies \u2039  \u2014 WordPress",$('meta[name="description"]').attr("content","Agencies"));if("#agencies"==window.location.hash)$("#wpbody-content").load("/agencies/list.html",
function(){x.agencies_load()});else if(-1!==window.location.hash.indexOf("#agencies/")){var a=window.location.hash.replace("#agencies/","");$("#wpbody-content").load("/agencies/form.html",function(){$.getScript("https://maps.googleapis.com/maps/api/js?key="+X_GOOGLE_API_KEY+"&callback=xInitMap");x.agencies_form_load(a)})}};var map,marker;
function xInitMap(){var a={lat:10.771797,lng:106.697833};map=new google.maps.Map(document.getElementById("map"),{center:a,zoom:6});marker=new google.maps.Marker({position:a,map:map,title:"Agency",draggable:!0});google.maps.event.addListener(marker,"dragend",function(a){var b=a.latLng.lat();a=a.latLng.lng();$("#lat").val(b);$("#lng").val(a)})}
x.agencies_init=function(){window.onhashchange=x.hash_run;$("head").append('<link rel="stylesheet" type="text/css" href="/agencies/s.min.css">');$("body").prepend('<div id="loading" class="loading"><div class="ball"></div><div class="ball1"></div></div>');$("#menu-settings").after('<li class="menu-top menu-icon-settings" id="menu-agencies"><a href="javascript:;" id="agencies-link" class="menu-top menu-icon-settings" aria-haspopup="false"><div class="wp-menu-image dashicons-before dashicons-admin-settings"><br></div><div class="wp-menu-name">Agencies </div></a></li>');
$("#agencies-link").click(function(){location.href="/wp-admin/#agencies"});x.hash_run()};
x.agencies_load=function(){$("#search-submit").click(function(){var a=x.change_alias($("#post-search-input").val()),b=x.agencies_list.slice(0);if(""!=a)for(i=b.length-1;0<=i;i--)-1===b[i].alias1.indexOf(a)&&-1===b[i].alias2.indexOf(a)&&b.splice(i,1);x.render_list(b)});x.vn_load(function(){x.call("agencies_list",{}).then(function(a){for(var b=0;b<a.length;b++)a[b].alias1=x.change_alias(a[b].name),a[b].alias2=x.change_alias(a[b].address);x.agencies_list=a;x.render_list(a)})})};
x.render_list=function(a){var b=$("#the-list");b.html("");var d=$("#agencies_tpl").html();$(".total-num").text(a.length);for(var e=0;e<a.length;++e){var c=a[e];b.append(d);var f=$("tr:last-child",b);f.attr("id","r-"+c.id);$(".agency-name",f).text(c.name);$(".agency-phone",f).text(c.phone);$(".agency-address",f).text(c.address);$(".agency-edit-link",f).attr("href","#agencies/"+c.id);$(".agency-trash-link",f).attr("data-id",c.id).click(x.agency_remove);for(var g in x.vn_data)g==c.province&&$(".agency-province",
f).text(x.vn_data[g].name)}};x.vn_load=function(a){null==a&&(a=function(){});if(void 0!==x.vn_data)return a();var b=localStorage.getItem("vn_data");if(null==b)$.get("/agencies/vn.json",function(b){x.vn_data=b;localStorage.setItem("vn_data",JSON.stringify(x.vn_data));return a()});else return x.vn_data=JSON.parse(b),a()};
x.agencies_form_load=function(a){var b,d;x.vn_load(function(){var e='<option value="-1">Choose a value</option>';for(b in x.vn_data)e+='<option value="'+b+'">'+x.vn_data[b].name+"</option>";$("#province").html(e);$("#province").change(function(){console.log("not change");var a='<option value="-1">Choose a value</option>',e=$(this).val();for(b in x.vn_data)if(b==e){var g=x.vn_data[b];for(d in g["quan-huyen"])a+='<option value="'+d+'">'+g["quan-huyen"][d].name+"</option>"}$("#district").html(a);null!==
x.agency?$("#district").val(x.agency.district):$("#district").val(-1)});""==a?x.agency=null:x.call("agencies_get&id="+a,null).then(function(a){x.agency=a;x.agency_form_fill()})});$("#agency_form").submit(function(a){a.preventDefault();x.call("agencies_put",$(this).serializeObject()).then(function(a){a.result?(x.agency=null,location.hash="#agencies"):alert(a.msg)});return!1})};
x.agency_form_fill=function(){$("#agency_id").val(x.agency.id);$("#name").val(x.agency.name);$("#address").val(x.agency.address);$("#lat").val(x.agency.lat);$("#lng").val(x.agency.lng);$("#phone").val(x.agency.phone);$("#province").val(x.agency.province).change();var a={lat:parseFloat(x.agency.lat),lng:parseFloat(x.agency.lng)};map.setCenter(a);marker.setPosition(a)};
x.agency_remove=function(){var a=$(this).attr("data-id");null==a?alert("Something went error!"):x.call("agencies_remove&id="+a,null).then(function(b){b.result?(alert("Successfully"),$("#r-"+a).remove(),b=$(".total-num").eq(0).text(),$(".total-num").text(0+b-1)):alert(b.msg)})};x.agencies_init();
